% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model_fitting.R
\name{ModelFitter}
\alias{ModelFitter}
\title{ModelFitter}
\description{
ModelFitter

ModelFitter
}
\details{
An R6 class for automatically fitting non-linear regression models.
Includes a library of pre-defined models to simplify selection.

This method returns a list containing information about the supported
non-linear models, including their names, descriptions, and the formulas they use. It serves
as a convenient reference for users to understand the available options and select the most
appropriate models for their dataset and objectives.

This method enables the inclusion of both built-in and custom models in the fitting
process. Users can select a predefined model from the library or provide the necessary
components to define a custom model, including a formula, starting parameters, and a function
to calculate predictions.

For custom models, the following components must be provided:
\itemize{
\item \code{name}: Name of the model
\item \code{formula}: A mathematical representation of the model.
\item \code{start_params}: A named list of starting parameter values for optimization.
\item \code{model_function}: A function that takes input \code{x} and parameter values as arguments
and returns the predicted \code{y} values.
}

The choice of fitting method depends on the arguments:
\itemize{
\item If \code{force_optim = TRUE}, the function will use \code{optim()} regardless of whether weights are supplied.
\item If \code{weights} is supplied, \code{optim()} will be used even if \code{force_optim = FALSE}.
\item If neither \code{force_optim} nor \code{weights} is supplied, the function defaults to \code{nls()} for unweighted fitting.
}

\strong{Behavior Examples}:
\enumerate{
\item \strong{Default behavior}: \code{nls()} is used when \code{weights = NULL} and \code{force_optim = FALSE}.
\item \strong{Weighted fitting}: \code{optim()} is used when \code{weights} is provided, even if \code{force_optim = FALSE}.
\item \strong{Forced optimization}: \code{optim()} is used when \code{force_optim = TRUE}, regardless of whether \code{weights} is supplied.
}

This method overlays the predictions of selected fitted models onto the observed data
across a specified range of the independent variable. The output is an interactive plot
generated using the \code{echarts4r} package, allowing users to visually assess the goodness of fit,
trends, and differences among models.

By default, predictions are normalized to allow fair comparison across models with different
scales. Users can customize the plotting range and apply specific visual themes for enhanced
interpretability.
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{data}}{A data.table containing the dataset for modeling.}

\item{\code{models}}{A list of non-linear models to test.}

\item{\code{fit_results}}{A list to store the results of model fits.}

\item{\code{evaluation_metrics}}{A list to store evaluation metrics for each model.}

\item{\code{plots}}{A list to store plots of model fits.}

\item{\code{model_library}}{A pre-defined library of common non-linear models.
Initialize the NonLinearFitter class}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-ModelFitter-new}{\code{ModelFitter$new()}}
\item \href{#method-ModelFitter-list_models}{\code{ModelFitter$list_models()}}
\item \href{#method-ModelFitter-add_model}{\code{ModelFitter$add_model()}}
\item \href{#method-ModelFitter-fit_models}{\code{ModelFitter$fit_models()}}
\item \href{#method-ModelFitter-model_comparison_plot}{\code{ModelFitter$model_comparison_plot()}}
\item \href{#method-ModelFitter-clone}{\code{ModelFitter$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ModelFitter-new"></a>}}
\if{latex}{\out{\hypertarget{method-ModelFitter-new}{}}}
\subsection{Method \code{new()}}{
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ModelFitter$new(data)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{data}}{A data.table containing the dataset for modeling.
Must include the predictor and response variable columns.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new instance of the NonLinearFitter class.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ModelFitter-list_models"></a>}}
\if{latex}{\out{\hypertarget{method-ModelFitter-list_models}{}}}
\subsection{Method \code{list_models()}}{
Retrieves a list of all non-linear models available for fitting in the \code{NonLinearFitter} class,
along with their descriptions and key details. This method provides an overview of the models
users can select for analysis.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ModelFitter$list_models()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A list summarizing available models.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ModelFitter-add_model"></a>}}
\if{latex}{\out{\hypertarget{method-ModelFitter-add_model}{}}}
\subsection{Method \code{add_model()}}{
Adds a specified non-linear model to the list of models to be fitted. This method allows users
to include predefined models or define their own custom models for analysis.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ModelFitter$add_model(
  name,
  formula = NULL,
  start_params = NULL,
  model_function = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{name}}{The name of the model (e.g., "Hill").}

\item{\code{formula}}{The non-linear formula for the model (optional if using pre-defined model).}

\item{\code{start_params}}{A list of starting parameters for the model (optional if using pre-defined model).}

\item{\code{model_function}}{A function used in fitting and prediction. See model_library for examples}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
NULL
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ModelFitter-fit_models"></a>}}
\if{latex}{\out{\hypertarget{method-ModelFitter-fit_models}{}}}
\subsection{Method \code{fit_models()}}{
\code{fit_models()} first standardizes your data before fitting the model.
The fitting method depends on whether a \code{weights_col} is provided: \code{nls()} is used
for unweighted fitting, while \code{optim()} is used for weighted fitting. The returned
parameters are based on the standardized data. However, when scoring models, the
results are back-transformed to align with the original data scale.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ModelFitter$fit_models(
  x_col,
  y_col,
  weights_col = NULL,
  loss = "mse",
  quantile_level = NULL,
  control = list(maxiter = 1024),
  cat_encoding = c("target_encoding", "credibility"),
  shift_cat = NULL,
  param_cat = NULL,
  param_links = NULL,
  ...
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{x_col}}{The name of the predictor variable.}

\item{\code{y_col}}{The name of the response variable.}

\item{\code{weights_col}}{The name of the weights variable.}

\item{\code{loss}}{choose from 'mse' or 'quantile'}

\item{\code{quantile_level}}{decimal between 0 and 1 representing the percentile of choice}

\item{\code{control}}{A list of control parameters for the optimizer, such as \code{maxiter}.
Default is \code{list(maxiter = 200)}.}

\item{\code{...}}{Additional arguments to be passed to the underlying fitting functions
(\code{nlsLM} for unweighted models or \code{optim} for weighted models). Examples include
\code{trace}, \code{lower}, and \code{upper} for \code{nlsLM}, or \code{reltol}, \code{parscale}, and others for \code{optim}.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A list of fitted model objects.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ModelFitter-model_comparison_plot"></a>}}
\if{latex}{\out{\hypertarget{method-ModelFitter-model_comparison_plot}{}}}
\subsection{Method \code{model_comparison_plot()}}{
Creates a visual comparison of multiple fitted non-linear models against the observed data.
This method helps evaluate the performance and fit of different models in a single, intuitive plot.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ModelFitter$model_comparison_plot(
  x_range = seq(1, 100, by = 1),
  normalize = TRUE,
  theme = "westeros"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{x_range}}{A numeric vector specifying the range of x values to evaluate.}

\item{\code{normalize}}{Logical. If TRUE, normalizes the y values for each model to fall between 0 and 1.
Defaults to TRUE.}

\item{\code{theme}}{A string specifying the plot theme (e.g., "macarons").}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
An \code{echarts4r} object representing the comparison plot.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ModelFitter-clone"></a>}}
\if{latex}{\out{\hypertarget{method-ModelFitter-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ModelFitter$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
